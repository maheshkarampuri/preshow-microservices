<!DOCTYPE html>
<html>
<head>
    <title>Razorpay Payment Test</title>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
</head>
<body>

<h2>Razorpay Payment</h2>
<button onclick="pay()">Pay Now</button>

<script>
    async function pay() {

        // Call backend to create payment + order
        const response = await fetch("http://localhost:8080/payment-service/payments", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
                "Authorization": "Bearer eyJraWQiOiJhdXRoLWtleSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiIzOGE3YWRmYi0xZjQ3LTQ1OGItYjI1OC1kZTIwMTk3N2FjNDAiLCJlbWFpbCI6ImdvdmluZEBnbWFpbC5jb20iLCJyb2xlIjoiVVNFUiIsImlhdCI6MTc2NzY3OTAzNSwiZXhwIjoxNzY3NzY1NDM1fQ.g2WjlC4MBYUOAODhjf-O2eDI7IN5AHgZtj8cSDloylbtZOUMYFNXCA01mIvwazNnLV0D3J0rLOt07vf5aaBRzzJOYRZqO_0Md3r0LOQGgpZkpF7qjopzbCPtO0gQWqSeRnXdczRyiXPpzR8wmyDbr-hDiUyGNfmj3cR8Q66StaM_Hm5E_AaV0-RwctvwhePDV4kc8-7K64g5rDoeL91kc1cE4br8689yKpMaNg9Oucn3KZfvlH94TZokkJNWS8DAMGuesHyP4W7_vuKGSl7WN0epwMc9KOfMGWlIRFnJBsDjklKEFH88mc3vksqBBRSJPxjzY94F01dpvfZEtIOZhw"
            },
            body: JSON.stringify({
                bookingId: "df5ee832-98bb-47dc-8b0c-99eb49a9e3d9",
                amount: 400
            })
        });

        const data = await response.json();

        // Razorpay Checkout
        const options = {
            key: data.keyId,
            amount: data.amount * 100, // paise
            currency: data.currency,
            order_id: data.razorpayOrderId,
            name: "PreShow",
            description: "Movie Ticket Payment",

            handler: function (response) {
                console.log("Frontend success callback", response);
                alert("Payment initiated. Final status via webhook.");
            }
        };

        const rzp = new Razorpay(options);
        rzp.open();
    }
</script>

</body>
</html>
